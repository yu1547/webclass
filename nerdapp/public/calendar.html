<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>排程表</title>
    <link href="fullcalendar.min.css" rel="stylesheet">
    <script src="moment.min.js"></script>
    <script src="jquery.min.js"></script>
    <script src="fullcalendar.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@3.10.2/dist/fullcalendar.min.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@3.10.2/dist/fullcalendar.min.js"></script>    <style>
        body {
            font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
            margin: 20px;
            display: flex;
            justify-content: space-between;
            /* Added to distribute space between the calendar and sidebar */
        }

        header h2 {
            text-align: center;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        #calendar {
            width: 65%;
            /* Adjusted width for the calendar */
            margin-top: 50px;
            /* Added margin to create space above the calendar */
            background-color: #c1d3ec;
            padding: 10px;
            border-radius: 10px;
        }

        #sidebar {
            width: 30%;
            background-color: #105aa7;
            padding: 10px;
            box-sizing: border-box;
            margin-top: 50px;
            border-radius: 25px;
        }

        #countdown,
        #todo-list,
        #task-completion {
            margin-bottom: 10px;
            text-align: center;
            background-color: #c1d3ec;
            border-radius: 25px;
        }

        #countdown h3,
        #todo-list h3 {
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        #navbar {
            position: fixed;
            top: 12px;
            background-color: #105aa7;
            color: rgb(32, 32, 32);
            cursor: pointer;
            z-index: 1;
            padding: 3px;
            border-radius: 30px;
            text-align: left;
            margin-left: 2%;
        }

        #dropdown-content {
            display: none;
            position: relative;
            background-color: #105aa7;
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(48, 48, 48, 0.2);
            z-index: 1;
            text-align: left;
        }

        #navbar:hover #dropdown-content {
            display: block;
        }

        #navbar:hover {
            border-radius: 30px;
            border: none;
        }

        .navbar-item {
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            padding: 7px;
            text-decoration: none;
            display: block;
            color: rgb(255, 255, 255);
        }

        .navbar-item:hover {
            background-color: #c1d3ec;
            color: #105aa7;
            border-radius: 30px;
            border: none;
        }

        #completed-tasks-chart {
            display: flex;
            flex-direction: row;
            /* Change to row to display tasks horizontally */
            align-items: center;
        }

        #completed-tasks-chart div {
            display: inline-block;
        }
    </style>
</head>

<body>
    <header>
        <h2 style="position: fixed;left:50%;top:5px;">月曆介面</h>
    </header>
    <div id="navbar">
        <a href="dashboard.html" class="navbar-item">重新調整</a>
        <!-- <div id="dropdown-content">
            <a href="#" class="navbar-item">考試 & 時間</a>
        </div> -->
    </div>

    <div id="calendar"></div>

    <div id="sidebar">
        <div id="countdown">
            <h3 style="padding-top:10px">倒數計時</h3>
            <div id="countdown-timer" style="font-family:Cambria;padding-bottom:10px"></div>
        </div>
        <div id="todo-list">
            <h3 style="padding-top:10px">今天的代辦事項</h3>
            <div id="todo-items" style="padding-bottom:10px">
                <!-- Checkbox added to each task -->
        </div>
        <div id="task-completion">
            <h3 style="padding-top: 10px">完成任務</h3>
            <div id="completion-chart-container" style="height: 200px;">
                <canvas id="completion-chart"></canvas>
            </div>

        </div>

    </div>
    <div class="gateway">
        <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">
            <img src="https://yu1547.github.io/webclass/images/gateway.png" alt="Art World Gateway">
            <p>通往藝世界的大門</p>
        </a>
    </div>


    <!-- Add this script tag to include Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
        // FullCalendar initialization
        $('#calendar').fullCalendar({
            height: 590,
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay'
            },
            nowIndicator: true,
            defaultView: 'agendaWeek',
            navLinks: true
        });

        // Countdown Timer
        var countdownDate = new Date("2023-12-31T23:59:59");
        var countdownElement = document.getElementById("countdown-timer");

        var countdownInterval = setInterval(function () {
            var now = new Date();
            var distance = countdownDate - now;

            var months = Math.floor(distance / (1000 * 60 * 60 * 24 * 30));
            var days = Math.floor((distance % (1000 * 60 * 60 * 24 * 30)) / (1000 * 60 * 60 * 24));

            var countdownText = "新年還有" + "<br>" + months + " M " + days + " D";

            countdownElement.innerHTML = countdownText;

            if (distance < 0) {
                clearInterval(countdownInterval);
                countdownElement.innerHTML = "EXPIRED";
            }
        }, 1000);

        // To-Do List
        var todoList = document.getElementById("todo-items");
        var completedTasks = document.getElementById("completed-tasks-chart");
        var tasks = ["Task 1", "Task 2", "Task 3", "Task 4", "Task 5"];

        tasks.forEach(function (task) {
            var listItem = document.createElement("div");
            
            // Create checkbox input element
            var checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.id = task;
            checkbox.name = task;
        
            // Create label for the checkbox
            var label = document.createElement("label");
            label.htmlFor = task;
            label.appendChild(document.createTextNode(task));
        
            // Append checkbox and label to listItem
            listItem.appendChild(checkbox);
            listItem.appendChild(label);
        
            // Add a change event listener to handle checkbox state changes
            checkbox.addEventListener('change', function () {
                if (checkbox.checked) {
                    completedTasks.appendChild(listItem);
                } else {
                    todoList.appendChild(listItem);
                }
                updateChart();
            });
        
            // Append listItem to todoList
            todoList.appendChild(listItem);
        });

        todoList.addEventListener('change', function (event) {
            if (event.target.type === 'checkbox') {
                if (event.target.checked) {
                    completedTasks.appendChild(event.target.parentElement);
                } else {
                    todoList.appendChild(event.target.parentElement);
                }
                updateChart();
            }
        });

        // Chart.js

        var completedTasksChartContainer = document.getElementById("completion-chart-container");
        var ctx = document.getElementById('completion-chart').getContext('2d');

        var dailyCompletion = 0;
        var weeklyCompletion = 0;
        var monthlyCompletion = 0;

        var completionChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Daily', 'Weekly', 'Monthly'],
                datasets: [{
                    label: 'Task Completion',
                    data: [dailyCompletion, weeklyCompletion, monthlyCompletion],
                    backgroundColor: ['#36a2eb', '#ff6384', '#4bc0c0'],
                }],
            },
            options: {
                responsive: true,
                scales: {
                    xAxes: [{
                        ticks: {
                            color: 'white',
                        }
                    }],
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            max: 100,
                            color: 'white',
                            callback: function (value) {
                                return value + '%';
                            }
                        }
                    }],
                },
                plugins: {
                    legend: {
                        labels: {
                            color: 'black',
                        }
                    }
                }
            },
        });

        function updateChart() {
            var completedCount = completedTasks.querySelectorAll('label').length;
            var completionPercentage = (completedCount / tasks.length) * 100;
        
            var weeklyTasksCount = tasks.length * 7;
            var weeklyCompletion = (completedCount / weeklyTasksCount) * 100;
        
            var monthlyTasksCount = tasks.length * 30;
            var monthlyCompletion = (completedCount / monthlyTasksCount) * 100;
        
            completionChart.data.datasets[0].data = [completionPercentage, weeklyCompletion, monthlyCompletion];
            completionChart.update();
        }
        
        
    });
</script>

</body>

</html>